
This documentation outlines how to utilize the RAMS loan evaluation model on your local computer. Below we will cover the packages you need to install, how to run the model, how to update the model when new versions are released, and the expected inputs to the model.

## Installation
Below are the packages you must install in order to use the model. If executed correctly, you should only need to follow these steps once:
1. Install [GIT](https://git-scm.com/downloads). Choose the option that is suitable for your computer. For example, if you have a Windows computer, download the windows option.
2. Download [Python](https://www.microsoft.com/en-us/p/python-310/9pjpw5ldxlz5?activetab=pivot:overviewtab). For Windows users, you can go to the microsoft store and download the latest python version for free on your computer. The Link provided is the latest windows supported python version available at the time of writing this documentation.
3. Instal numpy financial
   - Go to the command prompt
   - Navigate to the root directory by running the following command `cd`
   - Run the following command `pip install numpy-financial`
4. Install Openpyxl
   - Go to the command prompt
   - Navigate to the root directory by running the following command `cd`
   - Run the following command `pip install openpyxl`
5. Import the model
   - Go to the command prompt
   - Navigate to the root directory by running the following command `cd`
   - Navigate to your documents folder `cd documents`
   - Run the following command `git clone https://github.com/harrysolomon/loan_evaluation_model.git`

There should now be a folder within documents titled loan_evaluation_model

*Note: The model includes other python packages within it including: pandas, numpy, math, sys, and sqlite3, but these packages come for free when you download the latest python version (step 2).*

## Running the Model
1. Place a valid loan file into the test_files folder located in `documents/loan_evaluation_model/rams_loan_evaluation/test_files/` check out the test file section below for details on the contents of a valid loan file.
2. Go to the command prompt
   - Navigate to the root directory by running the following command `cd`
   - Navigate to the folder where the model lives `cd documents/loan_evaluation_model/rams_loan_evaluation`
   - Run the model with the following command `python3 __init__.py {test_file} {output_file}`
     - The test_file should be the name of the file you added in step 1. The filename **should not contain any spaces** and it should include the file extension in its name (the model supports .xlsx and .xlsm)
     - The output_file is what you want to call the output file generated by the model. The filename **should not contain any spaces** and it should include the file extension in its name (the model supports .xlsx and .xlsm)
     - Example command `python3 __init__.py hs_test_loans.xlsx hs_test_output.xlsx`

**If you want to stop the model at any time, type `ctrl c` into the command prompt**

## Version Control
This model may change overtime. Sometimes there will be changes to the model using the existing valid input file (non breaking change) and other times the change to the model will require a change to the input file as well (breaking change). Feel free to always pull the latest version of the code before performing the commands above. **I will notify users directly before I release a breaking change to the model.**

To pull the latest version of the model perform the following steps:
1. Go to the command prompt
   - Navigate to the root directory by running the following command `cd`
   - Navigate to the loan evaluation folder `cd documents/loan_evaluation_model`
   - run the following commands one after the other
   ```
   git checkout main
   git fetch origin
   git merge origin/main
   ```

## Input File Requirements
An invalid input file can lead to errors in the model or it could lead to undetected data anomalies in the end output. The model does not care what the columns headers are named, but it does expect values to be in specific locations. For example, the remaining term of a loan must be located in the 19th column of the file. In addition, it is also important that a column does not have a mix of data types in it. For example, the CDR column should always be of type (%). If some rows are of type (%) and other rows are of type (float), the model will not work appropriately. Lastly, the model expects column headers to be in the first row of the file, with the actual values preceding from row 2 onward.

Here is the column order of an input file along with its valid data type. This will be updated overtime as the input file changes.

| number | name | type|
| --- | --- | --- |
| 1 | Loan Count | number |
| 2 | Trade | string |
| 3 | LoanId | number |
| 4 | Loan Type | string |
| 5 | Lien Position | number |
| 6 | Property Type | string |
| 7 | Street | string |
| 8 | County | string |
| 9 | State | string |
| 10 | Zip Code | number |
| 11 | Property Value | currency |
| 12 | LTV | percentage |
| 13 | Max Default Recovery | percentage |
| 14 | Min Default Recovery | percentage |
| 15 | Default Recovery Calc | percentage |
| 16 | Next Due Date | date |
| 17 | Current UPB | currency |
| 18 | Gross Rate | percentage |
| 19 | WA Rem. Term (months) | number |
| 20 | Forbear tier 1 - mth | number |
| 21 | Forbear tier 1 - rate | percentage |
| 22 | Forbear tier 2 - mth | number |
| 23 | Forbear tier 2 - rate | percentage |
| 24 | Forbear tier 3 - mth | number |
| 25 | Forbear tier 3 - rate | percentage |
| 26 | Forbear tier 4 - mth | number |
| 27 | Forbear tier 4 - rate | percentage |
| 28 | Forbear tier 5 - mth | number |
| 29 | Forbear tier 5 - rate | percentage |
| 30 | First 23 Months | percentage |
| 31 | 24 | percentage |
| 32 | 360 | percentage |
| 33 | CPR tier 1 - mth | number |
| 34 | CPR tier 1 - rate | percentage |
| 35 | CPR tier 2 - mth | number |
| 36 | CPR tier 2 - rate | percentage |
| 37 | CPR tier 3 - mth | number |
| 38 | CPR tier 3 - rate | percentage |
| 39 | CPR tier 4 - mth | number |
| 40 | CPR tier 4 - rate | percentage |
| 41 | CPR tier 5 - mth | number |
| 42 | CPR tier 5 - rate | percentage |
| 43 | CDR | percentage |
| 44 | First 0 Months | percentage |
| 45 | 1 | percentage |
| 46 | 36 | percentage |
| 47 | Remaining Life of Pool | percentage |
| 48 | Prepay Penalty - Year 1 | percentage |
| 49 | Prepay Penalty - Year 2 | percentage |
| 50 | Prepay Penalty - Year 3 | percentage |
| 51 | Prepay Penalty - Year 4 | percentage |
| 52 | Prepay Penalty - Year 5 | percentage |
| 53 | Default Recovery | number |
| 54 | Investor Discount Rate | percentage |
| 55 | Sale - apply Buyer Discount Rate?     [YES/NO] | string |
| 56 | Buyer Discount Rate | percentage |
| 57 | Sale or Exit Price | percentage |
| 58 | Servicing Cost per Month ($) | currency |
| 59 | Servicing Cost per Month Post Exit (%) | percentage |
| 60 | Delinquency Factor | percentage |
| 61 | Hold to Maturity? | string |
| 62 | Sale Date (months from today) | number |
